<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Chat</title>
    <link rel="stylesheet" href="fontawesome-free-6.7.2-web/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="dark-theme"> <div id="app">
        <header>
            <div class="header-left">
                <button id="menu-toggle" title="Open Menu"><i class="fas fa-bars"></i></button>
            </div>
            <div id="chat-controls" class="header-center">
                <select id="chat-switcher" title="Switch between chats" style="display: none;"></select>
                <button id="hide-show-chat-btn" title="Hide/Show Current Chat" style="display: none;"><i class="fas fa-eye-slash"></i> Hide</button>
                <button id="delete-chat-btn" title="Delete Current Chat" style="display: none;"><i class="fas fa-trash-alt"></i></button>
                <button id="export-chat-btn" title="Export Current Chat" style="display: none;"><i class="fas fa-file-export"></i></button>
                <button id="import-chat-btn" title="Import Chat"><i class="fas fa-file-import"></i></button>
                <input type="file" id="import-file-input" accept=".json" style="display: none;"> </div>
            <div class="header-right">
                 <button id="new-chat-btn" title="Create a New Chat"><i class="fas fa-plus"></i> New Chat</button>
            </div>
        </header>

        <nav id="sidebar">
            <button id="close-sidebar-btn" title="Close Menu">&times;</button>
            <ul>
                <li><a href="#" id="explanation-link"><i class="fas fa-info-circle"></i> Explanation</a></li>
                <li><a href="#" id="preferences-link"><i class="fas fa-cog"></i> Preferences</a></li>
            </ul>
        </nav>

        <main id="main-content">
            <div id="chat-box-container">
                <div id="chat-box">
                    <div class="welcome-message">Use the buttons above to either import a saved chat or create a chat. Use the menu at the top left to view an explanation of how to use this app and to change preferences.</div>
                </div>
            </div>

            <div id="input-area" style="display: none;"> <span id="char-count" title="Character count in the textbox below">0 characters</span>
                <textarea id="message-input" placeholder="Type your message here..." title="Message Input Area"></textarea>
                <div class="button-row">
                    <button id="decrypt-btn" title="Decrypt text in input area"><i class="fas fa-unlock"></i> Decrypt</button>
                    <button id="paste-btn" title="Paste text from clipboard"><i class="fas fa-paste"></i> Paste</button>
                    <button id="encrypt-btn" title="Encrypt text in input area"><i class="fas fa-lock"></i> Encrypt</button>
                </div>
            </div>
        </main>

         <div id="notification-area"></div> </div>

    <div id="modal-overlay"></div>

    <div id="new-chat-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal-btn" title="Close">&times;</span>
            <h2>Create New Chat</h2>
            <form id="new-chat-form">
                <label for="chat-name">Chat Name:</label>
                <input type="text" id="chat-name" required title="Enter a unique name for the chat">

                <label for="chat-algorithm">Encryption Algorithm:</label>
                <select id="chat-algorithm" title="Select encryption method">
                    <option value="Nav Cipher" selected>Nav Cipher</option>
                    <!-- <option value="ChaCha20">ChaCha20</option> -->
                    <option value="AES">AES</option>
                </select>

                <label for="chat-password">Password/Passphrase:</label>
                <input type="password" id="chat-password" required title="Enter a password for this chat">

                <!-- <div class="checkbox-container">
                    <input type="checkbox" id="sms-optimization" title="Optimize for SMS (conceptual)">
                    <label for="sms-optimization">SMS Optimization</label>
                </div> -->

                <div class="modal-buttons">
                    <button type="button" class="cancel-btn">Cancel</button>
                    <button type="submit">Create Chat</button>
                </div>
            </form>
        </div>
    </div>

    <div id="preferences-modal" class="modal">
         <div class="modal-content">
            <span class="close-modal-btn" title="Close">&times;</span>
            <h2>Preferences</h2>
            <div class="preference-item">
                <label for="theme-toggle">Theme:</label>
                <button id="theme-toggle" title="Toggle between dark and light mode">
                    <i class="fas fa-moon"></i> Light Mode
                </button>
            </div>
             <div class="modal-buttons">
                 <button type="button" class="close-btn">Close</button>
            </div>
        </div>
    </div>

     <div id="explanation-modal" class="modal">
         <div class="modal-content">
            <span class="close-modal-btn" title="Close">&times;</span>
            <h2>How to use</h2>
            <p>This app uses very simple encryption and decryption techniques to allow you to keep text messages reasonably private. The encryption is not foolproof. It is only meant to provide a thin layer of obfuscation so that advertisers, scammers or any such unwanted data mining algorithms do not understand your personal chats, which is none of their business to eavesdrop upon. To avoid the fatigue of copying and pasting, use Private Chat only to encrypt a few messages you really want to keep private.</p>
            <ul>
                <li>Your friend and you decide on an encryption algorithm and password/passphrase on Private Chat. Do not share the password across any messaging app. Communicate it verbally. </li>
                <li>Both of you start a new chat on your devices. Type some text and click the Encrypt button. Click the Copy icon on the encrypted message that appears.</li>
                <li>Paste the encrypted text into any messaging app of your choice and send it to your friend.</li>
                <li>Your friend copies the received message and pastes it into their Private Chat using the Paste button and clicks the Decrypt button.</li>
                <li>You can start multiple chats and switch them using a dropdown menu at the top of the screen.</li>
                <li>You can hide chats and show them by typing the chat password.</li>
                <li>All data is stored temporarily in memory and is lost on refresh/close. If you need to save/load chats, use the Export/Import options. Passwords/passphrases will not be saved to storage.</li>
                <li>Private Chat does not transmit any data anywhere. The source code is freely available <a href="https://github.com/nav9/privateChat" target="_blank">here.</a></li>
            </ul>
             <div class="modal-buttons">
                 <button type="button" class="close-btn horizontal-center">Close</button>
            </div>
        </div>
    </div>

    <div id="confirmation-modal" class="modal">
        <div class="modal-content">
            <h2>Confirmation</h2>
            <p id="confirmation-message">Are you sure?</p>
             <div class="modal-buttons">
                <button id="confirm-cancel-btn" type="button">Cancel</button>
                <button id="confirm-action-btn" type="button">Confirm</button>
            </div>
        </div>
    </div>

     <div id="password-prompt-modal" class="modal">
        <div class="modal-content">
             <span class="close-modal-btn" title="Close">&times;</span>
            <h2 id="password-prompt-title">Enter Password</h2>
             <p id="password-prompt-message">Enter the password for this chat:</p>
            <input type="password" id="password-prompt-input" required>
             <div class="modal-buttons">
                <button id="password-prompt-cancel" type="button">Cancel</button>
                <button id="password-prompt-submit" type="button">Submit</button>
            </div>
        </div>
    </div>


    <script src="js/jquery-3.7.1.min.js"></script>
    <script src="js/crypto-js-3.1.9-1.min.js"></script>
    <script src="js/aes.min.js"></script>    
    <script src="js/script.js"></script>    
</body>
</html>
